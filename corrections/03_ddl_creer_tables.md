# Corrections — 03. DDL : créer des tables

## Exercice 1 — Table `notes`

Énoncé : créer une table `notes` :
- `id` auto-incrémentée
- `title` obligatoire
- `content` optionnel
- `created_at` avec `DEFAULT CURRENT_TIMESTAMP`

```sql
CREATE TABLE notes (
  id INT GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
  title VARCHAR(200) NOT NULL,
  content TEXT NULL,
  created_at TIMESTAMP NOT NULL DEFAULT CURRENT_TIMESTAMP
);
```

## Exercice 2 — Table `users` (qualité)

Énoncé : sur une table `users` :
- `email` obligatoire et unique
- `age` obligatoire et >= 0 (avec `CHECK`)
Puis : ajoutez 2 inserts OK et 2 inserts qui doivent échouer.

```sql
CREATE TABLE users (
  id INT GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
  email VARCHAR(255) NOT NULL UNIQUE,
  age INT NOT NULL,
  CONSTRAINT chk_users_age CHECK (age >= 0)
);
```

Inserts :
```sql
INSERT INTO users (email, age) VALUES ('a@exemple.com', 20);
INSERT INTO users (email, age) VALUES ('b@exemple.com', 0);

INSERT INTO users (email, age) VALUES ('a@exemple.com', 30); -- UNIQUE (erreur)
INSERT INTO users (email, age) VALUES ('c@exemple.com', -1); -- CHECK (erreur)
```

## Exercice 3 — Contraintes nommées

Énoncé : créer une table `users` avec des contraintes **nommées** :
- contrainte `UNIQUE` sur `email` nommée `uq_users_email`
- contrainte `CHECK (age >= 0)` nommée `chk_users_age`

```sql
CREATE TABLE users (
  id INT GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
  email VARCHAR(255) NOT NULL,
  age INT NOT NULL,
  CONSTRAINT uq_users_email UNIQUE (email),
  CONSTRAINT chk_users_age CHECK (age >= 0)
);
```

## Exercice 4 — Lire le schéma

Énoncé : exécuter `\d+ users`, puis répondre :
- Où voit-on le nom de la contrainte ?
- Comment sait-on que `email` est unique ?

- Les noms apparaissent dans `CONSTRAINT uq_users_email ...` et `CONSTRAINT chk_users_age ...`
- `email VARCHAR(255) NOT NULL` indique que l’email est obligatoire
- `UNIQUE (email)` indique l’unicité
